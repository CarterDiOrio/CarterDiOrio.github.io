"use strict";(self.webpackChunkportfolio=self.webpackChunkportfolio||[]).push([[432],{3553:function(e,t,n){n.r(t),n.d(t,{Head:function(){return p},default:function(){return f}});var r=n(8453),i=n(6540),a=n(6835),o=n(7159);function l(e){const t=Object.assign({h1:"h1",a:"a",span:"span",p:"p",img:"img",ol:"ol",li:"li",strong:"strong",h2:"h2",em:"em"},(0,r.R)(),e.components);return i.createElement(i.Fragment,null,i.createElement(t.h1,{id:"structure-from-motion",style:{position:"relative"}},i.createElement(t.a,{href:"#structure-from-motion","aria-label":"structure from motion permalink",className:"anchor before"},i.createElement(t.span,{dangerouslySetInnerHTML:{__html:'<svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg>'}})),"Structure from Motion"),"\n",i.createElement("div",{style:{maxWidth:"800px",margin:"auto"}},i.createElement("div",null,i.createElement(t.p,null,i.createElement(t.img,{src:"/dense.png",alt:"Image"})," ")),i.createElement(a.EY,{variant:"caption",style:{}},"A section of a dense recovered point cloud from KITTI")),"\n",i.createElement(t.p,null,"For my independent study project, I implemented a Structure from Motion (SfM) pipeline using an RGBD camera. The goal was to\neventually get a dense 3D reconstruction of the environment. The SfM (or Visual SLAM) pipeline has 2 main parts:"),"\n",i.createElement(t.ol,null,"\n",i.createElement(t.li,null,i.createElement(t.strong,null,"Odometry Estimation"),": The estimation of the camera motion using the RGBD camera."),"\n",i.createElement(t.li,null,i.createElement(t.strong,null,"Loop Closing"),": The detection of when the camera revisits a location and the optimization of the map."),"\n"),"\n",i.createElement(t.p,null,"The SfM method I implemented results in a sparse point cloud of map points. To then get a dense point cloud, I use the camera poses\noutput from SfM and fuse the depth maps from each frame to get a dense point cloud."),"\n",i.createElement("div",{style:{maxWidth:"800px",margin:"auto"}},i.createElement("div",null,i.createElement(t.p,null,i.createElement(t.img,{src:"/EstimatedPath.png",alt:"Image"})," ")),i.createElement(a.EY,{variant:"caption",style:{}},"Estimated vs Ground Truth Path on KITTI dataset zero.")),"\n",i.createElement(a.cG),"\n",i.createElement(t.h2,{id:"odometry-tracking-estimation",style:{position:"relative"}},i.createElement(t.a,{href:"#odometry-tracking-estimation","aria-label":"odometry tracking estimation permalink",className:"anchor before"},i.createElement(t.span,{dangerouslySetInnerHTML:{__html:'<svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg>'}})),"Odometry (Tracking) Estimation"),"\n",i.createElement(t.p,null,"The step in Structure from Motion is the estimation of the camera motion as part of the\n",i.createElement(t.em,null,"Tracking")," or ",i.createElement(t.em,null,"Frontend")," step. Motion is estimated in a 7 step process:"),"\n",i.createElement(t.ol,null,"\n",i.createElement(t.li,null,"Identify ORB features in the current frame."),"\n",i.createElement(t.li,null,"Match the ORB features with the previous frame."),"\n",i.createElement(t.li,null,"Estimate motion using PnP + RANSAC. Eliminate the outlier matches that are not consistent with the motion."),"\n",i.createElement(t.li,null,"Add new map points from the current frame."),"\n",i.createElement(t.li,null,"Project map points in the local area to the current frame."),"\n",i.createElement(t.li,null,"Match the projected local map points with still unmatched features/map points in the current frame."),"\n",i.createElement(t.li,null,"Refine the motion estimate using the new matches."),"\n"),"\n",i.createElement("div",{style:{maxWidth:"800px",margin:"auto"}},i.createElement(t.p,null,i.createElement(t.img,{src:"/Tracking.png",alt:"Image"})," ","\n",i.createElement(a.EY,{variant:"caption",style:{}},"A diagram of the tracking process"))),"\n",i.createElement(t.p,null,"This tracking process provides us with an odometry estimate of the camera motion akin to using encoders.\nConsequently, this means it drifts over time, as illustrated by a complete run on the KITTI dataset zero below."),"\n",i.createElement("div",{style:{maxWidth:"800px",margin:"auto"}},i.createElement(t.p,null,i.createElement(t.img,{src:"/Odometry.png",alt:"Image"})," ")),"\n",i.createElement(t.h2,{id:"loop-closing",style:{position:"relative"}},i.createElement(t.a,{href:"#loop-closing","aria-label":"loop closing permalink",className:"anchor before"},i.createElement(t.span,{dangerouslySetInnerHTML:{__html:'<svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg>'}})),"Loop Closing"),"\n",i.createElement(t.p,null,"To rectify this drift and enhance the precision of the position estimate, we can implement Loop Closing, a component of the Backend in SLAM.\nLoop Closing involves detecting when the camera revisits a previously visited location."),"\n",i.createElement("div",{style:{maxWidth:"800px",margin:"auto"}},i.createElement(t.p,null,i.createElement(t.img,{src:"/LoopClosing.png",alt:"Image"})," ")),"\n",i.createElement(t.p,null,"Before we can loop close and optimize the map, we need to detect when the camera revisits a location. I built a place recognition module\non top of a ",i.createElement(t.strong,null,"Visual Vocabulary")," and ",i.createElement(t.strong,null,"Bag of Words")," database (the DBoW2 library) that allows me to quickly query the database for similar images.\nFrom the query we get several similar images, to identify loops is then a 3 step process:"),"\n",i.createElement(t.ol,null,"\n",i.createElement(t.li,null,"Remove any images that were seen recently. For example the previous frame will have a high similarity score."),"\n",i.createElement(t.li,null,"For the camera to have looped, the same place must be consistently registered over multiple frames. This is the consistency validation."),"\n",i.createElement(t.li,null,"For any consistent matches, we then must perform geometric verification. Match features between the current frame and the match, then robustly\nesimate motion with RANSAC, and if there are enough inliers we have identified a loop."),"\n"),"\n",i.createElement(t.p,null,"After we have identified a loop, the loop is closed by fusing the duplciated map points and features in the current frame with the looped frame. This creates\nand edge in the graph. The graph is then optimized using Pose Graph Optimization. I used the ceres solver to optimize the graph. This process results\nin drift being corrected as shown in the before and after images below."),"\n",i.createElement(o.i,{columnsCountBreakPoints:{500:1,900:2},style:{maxWidth:"1200px",margin:"auto"}},i.createElement(o.A,{gutter:"8px"},i.createElement("div",null,i.createElement(t.p,null,i.createElement(t.img,{src:"/BeforeLoopClosure.png",alt:"Image"})," ")),i.createElement("div",null,i.createElement(t.p,null,i.createElement(t.img,{src:"/AfterLoopClosure.png",alt:"Image"})," ")))))}var s=function(e){void 0===e&&(e={});const{wrapper:t}=Object.assign({},(0,r.R)(),e.components);return t?i.createElement(t,e,i.createElement(l,e)):l(e)},c=n(6543),u=n(8142),m=n(6900),h=n(853);const d=e=>{let{data:t,children:n}=e;return(0,h.FD)(c.A,{children:[!t.mdx.frontmatter.underconstruction&&(0,h.FD)("div",{className:u.i,children:[(0,h.Y)("div",{sx:{paddingRight:"16px"},children:(0,h.FD)(a.Zp,{className:u.y,variant:"tableOfContents",children:[t.mdx.frontmatter.github&&(0,h.FD)("p",{children:["Github: ",(0,h.Y)("a",{href:t.mdx.frontmatter.github,sx:{color:"primary"},children:"Repository"})," "]}),(0,h.Y)(m.A,{items:t.mdx.tableOfContents.items})]})}),(0,h.Y)("div",{children:(0,h.Y)(r.x,{children:n})})]}),t.mdx.frontmatter.underconstruction&&(0,h.Y)("div",{children:(0,h.Y)("h2",{children:"Under Construction. Please check back later for updates"})})]})},p=e=>{let{data:t}=e;return(0,h.Y)("title",{children:t.mdx.frontmatter.title})};function f(e){return i.createElement(d,e,i.createElement(s,e))}},6900:function(e,t,n){var r=n(4506),i=n(6540),a=n(6835),o=n(4848);const l=e=>e.reduce((e,t)=>(t.url&&e.push(t.url.slice(1)),t.items&&e.push.apply(e,(0,r.A)(l(t.items))),e),[]),s=e=>{let{items:t,activeId:n,depth:r}=e;console.log(t);return(0,o.jsx)("ul",{style:{listStyleType:"none",paddingLeft:"16px"},children:t.map(e=>{const t=e.url==="#"+n?"tableOfContentsActive":"tableOfContents";return(0,o.jsxs)("li",{children:[(0,o.jsx)(a.k2,{href:e.url,variant:""+t,style:{fontSize:18-3*r+"px",opacity:""+(1-.2*r)},children:e.title}),e.items&&(0,o.jsx)(s,{items:e.items,activeId:n,depth:r+1})]},e.url)})})};t.A=e=>{let{items:t}=e;const n=(e=>{let{ids:t}=e;const[n,r]=i.useState("");return i.useEffect(()=>{const e=t.map(e=>document.getElementById(e)),n=new IntersectionObserver(e=>{e.forEach(e=>{if(e.isIntersecting){const t=e.target.getAttribute("id");r(t)}})},{rootMargin:"0% 0% -80% 0%"});return e.forEach(e=>n.observe(e)),()=>n.disconnect()},[]),n})({ids:l(t)});return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("h2",{children:"Contents"}),(0,o.jsx)(s,{items:t[0].items,activeId:n,depth:0})]})}},7159:function(e,t,n){n.d(t,{i:function(){return m},A:function(){return h}});var r=n(6540);function i(){return i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},i.apply(this,arguments)}function a(e,t){return a=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},a(e,t)}var o=function(e){var t,n;function o(){var t;return(t=e.call(this)||this).state={columns:[],childRefs:[],hasDistributed:!1},t}n=e,(t=o).prototype=Object.create(n.prototype),t.prototype.constructor=t,a(t,n);var l=o.prototype;return l.componentDidUpdate=function(){this.state.hasDistributed||this.props.sequential||this.distributeChildren()},o.getDerivedStateFromProps=function(e,t){var n=e.children,r=e.columnsCount,a=r!==t.columns.length;return t&&n===t.children&&!a?null:i({},o.getEqualCountColumns(n,r),{children:n,hasDistributed:!1})},l.shouldComponentUpdate=function(e){return e.children!==this.state.children||e.columnsCount!==this.props.columnsCount},l.distributeChildren=function(){var e=this,t=this.props,n=t.children,a=t.columnsCount,o=Array(a).fill(0);if(this.state.childRefs.every(function(e){return e.current.getBoundingClientRect().height})){var l=Array.from({length:a},function(){return[]}),s=0;r.Children.forEach(n,function(t){if(t&&r.isValidElement(t)){var n=e.state.childRefs[s].current.getBoundingClientRect().height,i=o.indexOf(Math.min.apply(Math,o));o[i]+=n,l[i].push(t),s++}}),this.setState(function(e){return i({},e,{columns:l,hasDistributed:!0})})}},o.getEqualCountColumns=function(e,t){var n=Array.from({length:t},function(){return[]}),i=0,a=[];return r.Children.forEach(e,function(e){if(e&&r.isValidElement(e)){var o=r.createRef();a.push(o),n[i%t].push(r.createElement("div",{style:{display:"flex",justifyContent:"stretch"},key:i,ref:o},e)),i++}}),{columns:n,childRefs:a}},l.renderColumns=function(){var e=this.props,t=e.gutter,n=e.itemTag,a=e.itemStyle;return this.state.columns.map(function(e,o){return r.createElement(n,{key:o,style:i({display:"flex",flexDirection:"column",justifyContent:"flex-start",alignContent:"stretch",flex:1,width:0,gap:t},a)},e.map(function(e){return e}))})},l.render=function(){var e=this.props,t=e.gutter,n=e.className,a=e.style,o=e.containerTag;return r.createElement(o,{style:i({display:"flex",flexDirection:"row",justifyContent:"center",alignContent:"stretch",boxSizing:"border-box",width:"100%",gap:t},a),className:n},this.renderColumns())},o}(r.Component);o.propTypes={},o.defaultProps={columnsCount:3,gutter:"0",className:null,style:{},containerTag:"div",itemTag:"div",itemStyle:{},sequential:!1};var l=o,s="undefined"!=typeof window?r.useLayoutEffect:r.useEffect,c=function(){var e=function(){var e=(0,r.useState)(!1),t=e[0],n=e[1];return s(function(){n(!0)},[]),t}(),t=(0,r.useState)("undefined"!=typeof window?window.innerWidth:0),n=t[0],i=t[1],a=(0,r.useCallback)(function(){e&&i(window.innerWidth)},[e]);return s(function(){if(e)return window.addEventListener("resize",a),a(),function(){return window.removeEventListener("resize",a)}},[e,a]),n},u=function(e){var t=e.columnsCountBreakPoints,n=void 0===t?{350:1,750:2,900:3}:t,i=e.gutterBreakPoints,a=void 0===i?{}:i,o=e.children,l=e.className,s=void 0===l?null:l,u=e.style,m=void 0===u?null:u,h=c(),d=(0,r.useCallback)(function(e,t){var n=Object.keys(e).sort(function(e,t){return e-t}),r=n.length>0?e[n[0]]:t;return n.forEach(function(t){t<h&&(r=e[t])}),r},[h]),p=(0,r.useMemo)(function(){return d(n,1)},[d,n]),f=(0,r.useMemo)(function(){return d(a,"10px")},[d,a]);return r.createElement("div",{className:s,style:m},r.Children.map(o,function(e,t){return r.cloneElement(e,{key:t,columnsCount:p,gutter:f})}))};u.propTypes={};var m=u,h=l},8142:function(e,t,n){n.d(t,{i:function(){return r},y:function(){return i}});var r="project-module--projectLayout--0a8d9",i="project-module--tableOfContents--da931"}}]);
//# sourceMappingURL=component---src-templates-project-tsx-content-file-path-src-projects-structure-from-motion-mdx-0aed393dbb834b4d0f8b.js.map